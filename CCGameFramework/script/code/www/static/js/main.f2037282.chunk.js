(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{133:function(e,t,a){e.exports=a(252)},141:function(e,t,a){},252:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"global",function(){return E});var i={};a.r(i),a.d(i,"player",function(){return k});var r={};a.r(r),a.d(r,"settings",function(){return O});var o=a(12),l=a(13),s=a(11),c=a(14),u=a(15),p=(a(98),a(60)),h=a(0),m=a.n(h),d=a(17),f=a.n(d),v=(a(141),a(16)),b=a(19),g=a(59);function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(b.a)({},e,t)}function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_GLOBAL_VALUE":return y(e,t.payload.changes);default:return e}}function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PLAYER_VALUE":return y(e,t.payload.changes);default:return e}}function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SETTINGS_VALUE":return y(e,t.payload.changes);default:return e}}var j={global:{vW:0,viewportWidth:0,viewportHeight:0,viewportMode:"portrait",scene:"normal"},player:{name:"\u533f\u540d\u73a9\u5bb6",level:1,exping:0,exped:0,money:0,blood:100,useblood:0,att:6,def:6,fightN:!1,fightA:0,fightL:[],maping:0,winN:[],states:{},role:[],roles:[],roleData:[]},settings:{Uplevel:100,ADD_blood:1,ADD_time:1e3,ADD_att:3,ADD_def:3,ADD_life:15,exped:[],map:[],animal:[],people:[],role:[],goods:[]}};j.settings.map=[[0,"\u6751\u5e84",[1,2],[0],[0,1,2]],[1,"\u6811\u67971",[0,3],[0,1],[]],[2,"\u8349\u4e1b1",[0,4],[0,1,2],[]],[3,"\u6811\u67972",[1,5],[2,4],[]],[4,"\u8349\u4e1b2",[2,6],[2,3,4],[]],[5,"\u68ee\u67971",[6,3,7],[3,5,4,6],[]],[6,"\u8349\u4e1b3",[4,5],[3,5],[]],[7,"\u68ee\u67972",[5,8],[6,7,8],[]],[8,"\u68ee\u67973",[7,9],[7,8],[]],[9,"\u706b\u5c711",[8,10],[9],[]],[10,"\u706b\u5c712",[9],[10],[]]],j.settings.animal=[["\u767d\u5154",1,28,7,5,2,5,3,2,"\u8349"],["\u5c0f\u9ec4\u72d7",2,35,11,9,5,3,5,2,"\u571f"],["\u5c0f\u82b1\u86c7",3,42,14,12,9,6,3,5,"\u8349"],["\u91ce\u732b",4,52,18,20,12,9,4,6,"\u571f"],["\u6bd2\u86c7",6,78,25,27,18,14,5,8,"\u571f"],["BOSS-\u9f20\u738b",5,250,50,48,120,30,10,10,"BOSS"],["\u7070\u9e1f",8,102,32,34,28,20,8,9,"\u98de"],["\u767d\u72fc",9,141,40,35,39,28,10,9,"\u722a"],["BOSS-\u730e\u8c79",10,2e3,100,100,300,50,20,20,"BOSS"],["\u706b\u9e21",11,182,45,40,43,34,15,5,"\u571f"],["BOSS-\u70c8\u7130",15,12e3,500,500,5e3,5e3,60,300,"BOSS"]],j.settings.people=[[0,"\u6751\u957f","\u7f57\u514b\u5148\u751f",0,"\u6211\u662f\u6751\u957f\u6211\u6700\u5927\uff0c\n\u6211\u7684\u5730\u76d8\u6211\u505a\u4e3b\u3002\n\u2026\u2026"],[1,"\u6751\u957f\u7684\u513f\u5b50","\u6469\u897f",0,"\u2026\u2026\u771f\u65e0\u804a\u3002\n\u4f60\u80fd\u548c\u6211\u4e00\u8d77\u73a9\u5417\uff1f"],[2,"\u6469\u897f\u7684\u73a9\u4f34","\u7eb3\u65af",0,"\u6469\u897f\uff0c\u548c\u6211\u73a9\u5427\u3002\n\u4f60\u5e72\u561b\u4e0d\u7406\u6211\uff1f\n\u545c\u545c\u2026\u2026"]],j.settings.role=[[[0,"\u5e2e\u6751\u957f\u6293\u767d\u5154","\u6211\u5f88\u997f\uff0c\u9ebb\u70e6\u4f60\u5e2e\u6211\u6293\u4e09\u53ea\u767d\u5154\u6765\u3002","\u597d\u5427\u3002","\u8bf7\u4f60\u627e\u522b\u4eba\u5427\uff0c\u6211\u5f88\u5fd9\u3002",[0,3],"\u8c22\u5566\uff0c\u8fd9\u4e0b\u53ef\u4ee5\u5403\u5154\u8089\u4e86\u2026\u2026","\u4e0d\u7528\u5ba2\u6c14\u3002",20,10],[0,"\u5c0f\u9ec4\u72d7\u4e8b\u4ef6","\u6700\u8fd1\u6751\u5185\u5f88\u591a\u4eba\u88ab\u5c0f\u9ec4\u72d7\u54ac\u4f24\u4e86\uff0c\u8bf7\u4f60\u53bb\u5904\u7406\u6389\u5341\u53ea\u3002","\u6211\u9a6c\u4e0a\u53bb\u3002","\u2026\u2026\u6050\u6015\u6211\u4e0d\u884c\u3002",[1,10],"\u4f60\u662f\u6211\u4eec\u6751\u7684\u5927\u82f1\u96c4\uff01","\u8fd9\u662f\u6211\u5e94\u8be5\u505a\u7684\u3002",60,50]],[[0,"\u9003\u8dd1\u7684\u5c0f\u767d\u5154","\u6211\u5fc3\u7231\u7684\u4e00\u53ea\u5c0f\u767d\u5154\u9003\u8dd1\u4e86\uff0c\u4f60\u80fd\u628a\u5b83\u6293\u6765\u5417\uff1f","\u5f53\u7136\u53ef\u4ee5\u3002","\u4e0d\u884c\uff0c\u6211\u53ef\u6293\u4e0d\u7740\u3002",[0,1],"\u8c22\u8c22\u4f60\uff01","\u5c0f\u83dc\u4e00\u789f\u3002",15,10],[0,"\u5904\u7406\u5c0f\u9ec4\u72d7","\u6211\u8c03\u67e5\u4e86\u4e00\u4e0b\uff0c\u539f\u6765\u662f\u5c0f\u9ec4\u72d7\u628a\u5b83\u6293\u8d70\u4e86\uff0c\u4f60\u80fd\u5e2e\u6211\u5417\uff1f","\u53ef\u4ee5\u3002","\u6211\u73b0\u5728\u5f88\u7d2f\u554a\u3002",[1,1],"\u975e\u5e38\u611f\u8c22\uff01","\u7528\u4e0d\u7740\u8fd9\u6837\u3002",12,15]],[[0,"\u6076\u6bd2\u7684\u5c0f\u82b1\u86c7","\u5c0f\u82b1\u86c7\u66fe\u7ecf\u628a\u6211\u7684\u5ba0\u7269\u54ac\u6b7b\u4e86\uff0c\u6240\u4ee5\u2026\u2026","\u7edd\u5bf9\u6ca1\u95ee\u9898\uff01","\u6240\u4ee5\u4ec0\u4e48\uff1f",[2,1],"\u8c22\u8c22\u4f60\u2026\u2026","\u6211\u80fd\u7406\u89e3\u4f60\u3002",15,22]]],j.settings.goods=[[0,0,"\u5c0f\u578b\u751f\u547d\u836f\u6c34",8,20,4],[1,0,"\u5c0f\u578b\u751f\u547d\u836f\u6c34A",10,20,0],[2,0,"\u4e2d\u578b\u751f\u547d\u836f\u6c34",25,50,5],[3,0,"\u4e2d\u578b\u751f\u547d\u836f\u6c34A",32,50,0],[4,0,"\u5927\u578b\u751f\u547d\u836f\u6c34",50,100,10],[5,0,"\u5927\u578b\u751f\u547d\u836f\u6c34A",60,100,0],[6,1,"\u5c0f\u578b\u7ecf\u9a8c\u836f\u6c34",150,60,2]];for(var D=1;D<=j.settings.Uplevel;D++)j.settings.exped[D]=3+D*(D+1)*(D+2)/3;j.player.useblood=j.player.blood,j.player.exped=j.settings.exped[j.player.level],j.player.role=j.settings.role.map(function(){return!1}),j.player.roles=j.settings.role.map(function(){return 0}),j.player.roleData=j.settings.role.map(function(){return{type:-1}});var w=function(e){var t=Object(g.b)(Object(b.a)({},n,i,r));return"object"===typeof window?Object(g.c)(t,e,window.devToolsExtension?window.devToolsExtension():void 0):Object(g.c)(t,e)}(j);function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};w.dispatch({type:"SET_GLOBAL_VALUE",payload:{changes:Object(b.a)({},e)}})}var x=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e,t=this;this.setViewportModel(this.getViewportModel()),window.onresize=function(){clearTimeout(e),e=setTimeout(function(){t.setViewportModel(t.getViewportModel())},50)}}},{key:"getViewportModel",value:function(){var e=window.innerWidth,t=window.innerHeight;if(e<=600)return{width:e,height:t,mode:"portrait"};var a=Math.round(.56*e);return a>t?{width:Math.round(16*t/9),height:t,mode:"landscape"}:{width:e,height:a,mode:"landscape"}}},{key:"setViewportModel",value:function(e){!function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"portrait";w.dispatch({type:"SET_GLOBAL_VALUE",payload:{changes:{vW:Math.round(e/100),vH:Math.round(t/100),viewportMode:a,viewportWidth:e,viewportHeight:t}}})}(e.width,e.height,e.mode)}},{key:"render",value:function(){if(this.props.viewportWidth<=0||this.props.viewportHeight<=0)return null;var e={position:"relative",width:this.props.viewportWidth,height:this.props.viewportHeight,margin:"0 auto",overflow:"hidden",fontSize:"portrait"===this.props.viewportMode?4*this.props.vW:2*this.props.vW},t="RPGScene--"+this.props.viewportMode;return m.a.createElement("div",{style:e,className:t},this.props.children)}}]),t}(m.a.Component),C=Object(v.b)(function(e,t){return{vW:e.global.vW,vH:e.global.vH,viewportMode:e.global.viewportMode,viewportWidth:e.global.viewportWidth,viewportHeight:e.global.viewportHeight}})(x),S=(a(31),a(10)),I=(a(24),a(6)),A=a(61);function L(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=Object(b.a)({defaultTextColor:"#000"},t),n=[];return e.forEach(function(e,t){if(e.match(/@@pause_/)){var i=e.match(/\d+/g)[0];n=Object(A.a)(n).concat([{color:a.defaultTextColor,char:" ",msToNextChar:parseInt(i,10)}])}else{var r=50,o=a.defaultTextColor;if(e.match(/^\[LIGHTNING\]/i)&&(e=e.replace("[LIGHTNING]",""),r=10),e.match(/^\[FAST\]/i)&&(e=e.replace("[FAST]",""),r=35),e.match(/^\[SLOW\]/i)&&(e=e.replace("[SLOW]",""),r=140),e.match(/^\[CRAWL\]/i)&&(e=e.replace("[CRAWL]",""),r=360),e.match(/^@@color_/)){var l=e.match(/@@(.*)@@/).pop();o=l.replace("color_",""),e=e.replace("@@".concat(l,"@@"),"")}var s=e.split("").map(function(e){return{color:o,char:e,msToNextChar:" "!==e?r:0}});n=Object(A.a)(n).concat(Object(A.a)(s))}}),n}var _=a(95),N={sfx_typeBlip:{src:["/sfx/blip.wav"],volume:.75},sfx_ring:{src:["/sfx/ring.mp3"],volume:1}},M={};Object.keys(N).forEach(function(e){M[e]=new _.Howl(N[e])});var W=function(e){M[e].play()},F=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).animFrameStep=null,a.state={revealedIndex:-1},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.revealNext(Date.now()+10)}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.animFrameStep)}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.isForcedDone&&(cancelAnimationFrame(this.animFrameStep),this.setState({revealedIndex:999},function(){"function"===typeof t.props.onDone&&t.props.onDone()}))}},{key:"revealNext",value:function(e){var t=this;this.animFrameStep=requestAnimationFrame(function a(){if(Date.now()<e)t.animFrameStep=requestAnimationFrame(a);else{var n=t.state.revealedIndex+1;t.setState({revealedIndex:n},function(){if(n<t.props.lineData.length-1){" "!==t.props.lineData[n].char&&W("sfx_typeBlip");var e=t.props.lineData[n].msToNextChar;t.revealNext(Date.now()+e)}else"function"===typeof t.props.onDone&&t.props.onDone()})}})}},{key:"render",value:function(){var e=this,t=this.props.lineData.map(function(t,a){var n={opacity:a<=e.state.revealedIndex?1:0,color:t.color,fontFamily:"Kaiti",fontSize:"24px"};return m.a.createElement("span",{key:"txtline_".concat(a),style:n},t.char)});return m.a.createElement("span",null,t)}}]),t}(m.a.Component),U=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={isForcedDone:!1},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"handleClick",value:function(){this.setState({isForcedDone:!0})}},{key:"render",value:function(){return m.a.createElement("span",{onClick:this.handleClick.bind(this),style:this.props.style||{}},m.a.createElement(F,{isForcedDone:this.state.isForcedDone,lineData:this.props.lineData,onDone:this.props.onDone}))}}]),t}(m.a.Component),H=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return m.a.createElement(U,{lineData:this.props.text,onDone:this.props.onTextComplete.bind(this)})}}]),t}(m.a.Component),B=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={isHidden:!1},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"handleTransitionEnd",value:function(){var e=this;"function"===typeof this.props.onTransitionComplete&&this.setState({isHidden:!0},function(){e.props.onTransitionComplete()})}},{key:"render",value:function(){if(this.state.isHidden)return null;var e={position:"absolute",zIndex:100,left:0,right:0,top:0,bottom:0,background:"#151825 radial-gradient(50% 105%, rgba(40,48,79,0.00) 52%, rgba(11,15,32,0.70) 100%)",opacity:this.props.isOpaque?1:0,transition:"opacity 1.5s"};return m.a.createElement("div",{style:e,onTransitionEnd:this.handleTransitionEnd.bind(this)})}}]),t}(m.a.Component),R=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getMobileStyle",value:function(){return{height:30*this.props.vH,padding:"10% 8% 0%",lineHeight:"1.8em"}}},{key:"getDesktopStyle",value:function(){var e=this.props,t=e.vH,a=e.vW;return{width:88*a,height:88*t,bottom:0,left:0,paddingTop:3*a,paddingLeft:3*a,paddingRight:3*a,fontSize:"1em",lineHeight:"2.2em"}}},{key:"render",value:function(){var e="portrait"===this.props.viewportMode?this.getMobileStyle():this.getDesktopStyle(),t=Object(b.a)({position:"relative",zIndex:3,backgroundColor:"#000",backgroundRepeat:"no-repeat",backgroundSize:"100%"},e);return m.a.createElement("div",{style:t},this.props.children)}}]),t}(m.a.Component),G=Object(v.b)(function(e,t){return{viewportMode:e.global.viewportMode,vH:e.global.vH,vW:e.global.vW}})(R),z=(a(100),a(75)),V=(a(152),a(129)),q=(a(155),a(130)),P=(a(53),a(25)),$=(a(158),a(18)),J=(a(45),a(20)),Y=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={text:"",visible:!1,confirmLoading:!1,errMsg:""},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this;setTimeout(function(){e.showModal()},100)}},{key:"emitEmpty",value:function(){this.input.focus(),this.setState({text:""})}},{key:"onChangeUserName",value:function(e){this.setState({text:e.target.value})}},{key:"showModal",value:function(){W("sfx_ring"),this.setState({visible:!0})}},{key:"handleNameSubmit",value:function(e){var t=this;e&&e.preventDefault(),setTimeout(function(){t.props.onNameReceived(t.state.text)},100)}},{key:"handleOk",value:function(){var e=this,t=this.state.text;return""===t?(J.a.error("\u8bf7\u91cd\u65b0\u8f93\u5165"),void this.setState({errMsg:"\u540d\u5b57\u4e0d\u80fd\u4e3a\u7a7a"})):t.length>10?(J.a.error("\u8bf7\u91cd\u65b0\u8f93\u5165"),void this.setState({errMsg:"\u540d\u5b57\u4e0d\u80fd\u8d85\u8fc710\u4e2a\u5b57\u7b26"})):(this.setState({confirmLoading:!0}),void setTimeout(function(){e.setState({visible:!1,confirmLoading:!1}),J.a.success("\u8f93\u5165\u6210\u529f\uff01"),e.handleNameSubmit.call(e)},500))}},{key:"render",value:function(){var e=this,t=this.state,a=t.visible,n=t.confirmLoading,i=t.text,r=t.errMsg,o=i?m.a.createElement($.a,{type:"close-circle",onClick:this.emitEmpty.bind(this)}):null;return m.a.createElement("div",null,m.a.createElement(z.a,{title:"\u8f93\u5165\u540d\u5b57",visible:a,confirmLoading:n,footer:[m.a.createElement(P.a,{key:"submit",type:"primary",loading:n,onClick:this.handleOk.bind(this)},"\u786e\u5b9a")]},""!==r?m.a.createElement("p",null,m.a.createElement(q.a,{message:r,type:"error",showIcon:!0})):null,m.a.createElement("p",null,m.a.createElement(V.a,{placeholder:"\u8f93\u5165\u540d\u5b57",prefix:m.a.createElement($.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),suffix:o,value:i,onChange:this.onChangeUserName.bind(this),ref:function(t){return e.input=t}}))))}}]),t}(m.a.Component);function K(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};w.dispatch({type:"SET_PLAYER_VALUE",payload:{changes:Object(b.a)({},e)}})}var Q=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={isOverlayOpaque:!0,isLaptopLowered:!1,step:"fade-out",nameFromUser:""},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.setState({isOverlayOpaque:!1})},200)}},{key:"handleOverlayDone",value:function(){var e=this;setTimeout(function(){e.setState({step:"intro"})},200)}},{key:"handleNameReceived",value:function(e){this.setState({step:"nice-to-meet-you",nameFromUser:e}),K({name:e})}},{key:"exitIntro",value:function(){setTimeout(function(){T({scene:"normal"})},600)}},{key:"getIntroText",value:function(){return["\u4f60\u597d\uff01","@@pause_1000@@","\u6b22\u8fce\u6765\u5230","@@color_yellow@@CC RPG WORLD\uff01","@@pause_1000@@","\u7248\u672c 0.1\uff01","@@pause_100@@"]}},{key:"getDesktopWrap",value:function(){return"portrait"===this.props.viewportMode?{}:{width:"100%",margin:"0 auto"}}},{key:"setNextStep",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;setTimeout(function(){t.setState({step:e})},a)}},{key:"renderContent",value:function(){if("intro"===this.state.step){var e=L(this.getIntroText(),{defaultTextColor:"#fff"});return m.a.createElement(H,{key:"1",text:e,onTextComplete:this.setNextStep.bind(this,"intro2")})}if("intro2"===this.state.step||"getName"===this.state.step){var t=L(["\u8bf7\u8f93\u5165\u4f60\u7684\u540d\u5b57\uff01"],{defaultTextColor:"#fff"});return m.a.createElement(H,{key:"2",text:t,onTextComplete:this.setNextStep.bind(this,"getName",200)})}if("nice-to-meet-you"===this.state.step){var a=L(["\u592a\u68d2\u4e86\uff01","@@pause_1000@@","\u6b22\u8fce\u5149\u4e34\uff01","@@color_yellow@@".concat(this.state.nameFromUser),"\uff01"],{defaultTextColor:"#fff"});return m.a.createElement(H,{key:"3",text:a,onTextComplete:this.setNextStep.bind(this,"end")})}if("end"===this.state.step){var n=L(["\u73b0\u5728\u5f00\u59cb\u6e38\u620f\u5427\uff01"],{defaultTextColor:"#fff"});return m.a.createElement(H,{key:"4",text:n,onTextComplete:this.setNextStep.bind(this,"wait")})}if("wait"===this.state.step){var i=L(["Loading..."],{defaultTextColor:"#fff"});return m.a.createElement(H,{key:"5",text:i,onTextComplete:this.setNextStep.bind(this,"over")})}return"over"===this.state.step&&this.exitIntro(),null}},{key:"renderNameModal",value:function(){if("getName"===this.state.step)return m.a.createElement(Y,{onNameReceived:this.handleNameReceived.bind(this),viewportMode:this.props.viewportMode})}},{key:"render",value:function(){var e={fontSize:"portrait"===this.props.viewportMode?"0.8em":"0.5em"},t=Object(b.a)({},this.getDesktopWrap());return m.a.createElement("div",null,m.a.createElement(B,{isOpaque:this.state.isOverlayOpaque,onTransitionComplete:this.handleOverlayDone.bind(this)}),m.a.createElement(S.a,{type:"flex",justify:"space-around",align:"middle"},m.a.createElement(I.a,{style:e},m.a.createElement("div",{style:t},this.state.isLaptopLowered?null:m.a.createElement(G,null,this.renderContent())),this.renderNameModal())))}}]),t}(m.a.Component),X=Object(v.b)(function(e,t){return{viewportMode:e.global.viewportMode}})(Q),Z=(a(65),a(39)),ee=(a(49),a(30)),te=(a(50),a(28)),ae=a(23),ne=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={addID:setTimeout(a.addBlood.bind(Object(ae.a)(Object(ae.a)(a))),a.props.ADD_time)},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.state.addID>=0&&clearTimeout(this.state.addID)}},{key:"addBlood",value:function(){var e=this.props,t=e.blood,a=e.useblood;a<0||(a>t||a+this.props.ADD_blood>t?K({useblood:t}):K({useblood:a+this.props.ADD_blood}),this.setState({addID:setTimeout(this.addBlood.bind(this),this.props.ADD_time)}))}},{key:"render",value:function(){var e=this.props,t=e.blood,a=e.useblood,n=100*a/t,i=a<t,r="".concat(a,"/").concat(t);return m.a.createElement(ee.a,{content:r,title:"\u751f\u547d"},m.a.createElement(S.a,null,m.a.createElement(I.a,{span:6},"\u751f\u547d\uff1a"),m.a.createElement(I.a,{span:18},i?m.a.createElement(te.a,{percent:n,showInfo:!1,status:n<20?"exception":"active"}):m.a.createElement(te.a,{percent:n,showInfo:!1}))))}}]),t}(m.a.Component),ie=Object(v.b)(function(e,t){return{blood:e.player.blood,useblood:e.player.useblood,ADD_blood:e.settings.ADD_blood,ADD_time:e.settings.ADD_time}})(ne);function re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};w.dispatch({type:"SET_SETTINGS_VALUE",payload:{changes:Object(b.a)({},e)}})}var oe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={expID:setTimeout(a.checkUpgrade.bind(Object(ae.a)(Object(ae.a)(a))),1e3)},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.state.expID>=0&&clearTimeout(this.state.expID)}},{key:"checkUpgrade",value:function(){var e=this.props,t=e.exping,a=e.exped,n=e.player,i=e.Uplevel,r=e.Exped,o=e.ADD_life,l=e.ADD_att,s=e.ADD_def,c=e.ADD_blood;t>=a&&n.level<i&&n.useblood>0&&(n.level%10===0&&re({ADD_blood:c+1}),K({level:n.level+1,blood:n.blood+o,att:n.att+l,def:n.def+s,exping:t-a,exped:r[n.level]}),J.a.success("<".concat(n.name,">\u5347\u5230\u4e86<").concat(n.level+1,">\u7ea7\uff01"))),this.setState({expID:setTimeout(this.checkUpgrade.bind(this),1e3)})}},{key:"render",value:function(){var e=this.props,t=e.exping,a=e.exped,n=100*t/a,i="".concat(t,"/").concat(a);return m.a.createElement(ee.a,{content:i,title:"\u7ecf\u9a8c"},m.a.createElement(S.a,null,m.a.createElement(I.a,{span:6},"\u7ecf\u9a8c\uff1a"),m.a.createElement(I.a,{span:18},m.a.createElement(te.a,{percent:n,showInfo:!1}))))}}]),t}(m.a.Component),le=Object(v.b)(function(e,t){return{exping:e.player.exping,exped:e.player.exped,player:e.player,Uplevel:e.settings.Uplevel,Exped:e.settings.exped,ADD_blood:e.settings.ADD_blood,ADD_life:e.settings.ADD_life,ADD_att:e.settings.ADD_att,ADD_def:e.settings.ADD_def}})(oe),se=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.level,a=e.money,n=e.att,i=e.def;return m.a.createElement("div",null,m.a.createElement(S.a,null,m.a.createElement(I.a,{span:6},"\u7b49\u7ea7\uff1a"),m.a.createElement(I.a,{span:18},t)),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:6},"\u91d1\u94b1\uff1a"),m.a.createElement(I.a,{span:18},"$",a)),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:6},"\u653b\u51fb\uff1a"),m.a.createElement(I.a,{span:18},n)),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:6},"\u9632\u5fa1\uff1a"),m.a.createElement(I.a,{span:18},i)))}}]),t}(m.a.Component),ce=Object(v.b)(function(e,t){return{level:e.player.level,money:e.player.money,att:e.player.att,def:e.player.def}})(se),ue=a(21),pe=a.n(ue);function he(e){switch(e){case 0:return"\u751f\u547d";case 1:return"\u7ecf\u9a8c"}return"good: unknown id"}function me(e){return 0===e?"\u7acb\u5373":"".concat(e,"\u79d2\u5185")}function de(e,t){0===t[1]&&K({useblood:pe.a.min([e.blood,e.useblood+t[4]/t[5]])})}function fe(e){switch(e){case 0:return"\u6253\u8d25\u602a\u7269"}return"task: unknown type"}function ve(){var e=Math.floor(100*Math.random());return e>=0&&e<50?1:e>=50&&e<80?2:e>=80&&e<95?3:e>=95&&e<=98?5:e>98&&e<=99?10:void 0}var be=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={checkingID:setTimeout(a.checkingTimeout.bind(Object(ae.a)(Object(ae.a)(a))),1e3),goodID:-1},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.state.goodID>=0&&clearTimeout(this.state.goodID),this.state.checkingID>=0&&clearTimeout(this.state.checkingID)}},{key:"checkingTimeout",value:function(){this.props.player.useblood>0&&(null!=this.props.states.good&&null!=this.props.states.good.obj&&-1===this.state.goodID&&this.setState({goodID:setTimeout(this.goodTimeout.bind(this),100)}),this.setState({checkingID:setTimeout(this.checkingTimeout.bind(this),1e3)}))}},{key:"goodTimeout",value:function(){var e=this.props.states.good,t=e.count,a=e.all,n=e.obj;t%100===0&&de(this.props.player,n),K({states:{good:{obj:n,count:t+10,all:a}}}),t+10<=a?this.setState({goodID:setTimeout(this.goodTimeout.bind(this),100)}):(this.setState({goodID:-1}),K({states:{good:null}}))}},{key:"goodState",value:function(e,t){var a=t.obj,n=he(a[1]),i=100*t.count/t.all,r=m.a.createElement("div",null,m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u8fdb\u5ea6\uff1a"),m.a.createElement(I.a,{span:16},m.a.createElement(te.a,{size:"small",percent:i,width:80,showInfo:!1}))),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u7c7b\u578b\uff1a"),m.a.createElement(I.a,{span:16},n,"\u836f\u6c34")),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u91d1\u94b1\uff1a"),m.a.createElement(I.a,{span:16},a[3])),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u6548\u679c\uff1a"),m.a.createElement(I.a,{span:16},me(a[5]),"\u589e\u52a0",a[4],n)));return m.a.createElement(ee.a,{key:"state_".concat(e),content:r,title:"\u72b6\u6001 -- <".concat(a[2],">")},m.a.createElement(P.a,{size:"small"},a[2]))}},{key:"conv",value:function(e){var t=this.props.states[e];if(null===t)return null;switch(e){case"good":return this.goodState(e,t)}return null}},{key:"stateList",value:function(){var e=this.props.states,t=pe.a.keys(e).map(this.conv.bind(this)).filter(function(e){return null!==e});return 0===t.length?"\u65e0":t}},{key:"render",value:function(){return m.a.createElement(S.a,null,m.a.createElement(I.a,{span:6},"\u72b6\u6001\uff1a"),m.a.createElement(I.a,{span:18},this.stateList()))}}]),t}(m.a.Component),ge=Object(v.b)(function(e,t){return{player:e.player,states:e.player.states}})(be),ye=a(76),Ee=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={checkingID:setTimeout(a.checkingTimeout.bind(Object(ae.a)(Object(ae.a)(a))),1e3)},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.state.checkingID>=0&&clearTimeout(this.state.checkingID)}},{key:"completeTask0",value:function(e){var t=this.props,a=t.roleList,n=t.player,i=t.role,r=t.roles,o=t.money,l=t.exping,s=a[e][n.roles[e]],c=["<".concat(n.name,">\u5b8c\u6210\u4e86<").concat(s[1],">\u4efb\u52a1\uff01"),"<".concat(n.name,">\u83b7\u5f97\u4e86<$").concat(s[8],"\u91d1\u94b1>\u548c<").concat(s[9],"\u7ecf\u9a8c>\uff01")];J.a.success(c[0]),J.a.success(c[1]),i[e]=!1,r[e]++,K({money:o+s[8],exping:l+s[9],role:i,roles:r})}},{key:"checkTask0Info",value:function(e){var t=e.id,a=e.count,n=this.props.roleData;for(var i in n){var r=n[i];if(0===r.type&&r.id===t&&(n[i].count=a+r.count,n[i].count>=r.all))return n[i]={type:-1},void this.completeTask0(i)}K({roleData:n})}},{key:"checkTask0",value:function(){var e=this.props.winN;e.length>0&&(pe()(e).forEach(this.checkTask0Info.bind(this)),setTimeout(function(){return K({winN:[]})},0))}},{key:"checkTask",value:function(){this.checkTask0()}},{key:"checkingTimeout",value:function(){this.props.player.useblood>0&&(this.checkTask(),this.setState({checkingID:setTimeout(this.checkingTimeout.bind(this),1e3)}))}},{key:"taskTarget0",value:function(e){var t=Object(ye.a)(e[5],2),a=t[0],n=t[1],i=this.props.animal[a];return"\u6253\u8d25<".concat(n,">\u53ea<").concat(i[0],">")}},{key:"taskTarget",value:function(e){switch(e[0]){case 0:return this.taskTarget0(e)}return"task: unknown target"}},{key:"taskProgress0",value:function(e,t){var a=e.all,n=e.count;return Math.floor(100*n/a)}},{key:"taskProgress",value:function(e,t){switch(t[0]){case 0:return this.taskProgress0(e,t)}return"task: unknown progress"}},{key:"taskInfo0",value:function(e,t,a){var n=this.props,i=n.people,r=n.roleData,o=i[e],l=this.taskProgress(r[e],a),s=m.a.createElement("div",null,m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u4eba\u7269\uff1a"),m.a.createElement(I.a,{span:16},m.a.createElement("b",null,o[1]," - ",o[2]))),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u7c7b\u578b\uff1a"),m.a.createElement(I.a,{span:16},m.a.createElement("b",null,fe(a[0])))),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u76ee\u6807\uff1a"),m.a.createElement(I.a,{span:16},m.a.createElement("b",null,this.taskTarget(a)))),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u5956\u52b1\uff1a"),m.a.createElement(I.a,{span:16},m.a.createElement("b",null,"<$",a[8],">\u91d1\u94b1"),m.a.createElement("br",null),m.a.createElement("b",null,"<",a[9],">\u7ecf\u9a8c"))),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u8fdb\u5ea6\uff1a"),m.a.createElement(I.a,{span:16},m.a.createElement(te.a,{type:"circle",size:"small",percent:l,width:40}))));return m.a.createElement(ee.a,{key:"tasks_".concat(e,"_").concat(t),content:s,title:"\u4efb\u52a1 -- <".concat(a[1],">")},m.a.createElement(P.a,{size:"small"},a[1]))}},{key:"conv",value:function(e){var t=this.props,a=t.roleList,n=t.player,i=a[e],r=n.roles[e],o=i[r];switch(o[0]){case 0:return this.taskInfo0(e,r,o)}return"task: unknown type"}},{key:"taskList",value:function(){var e=this.props.role,t=pe.a.chain(e).map(function(e,t){return[e,t]}).filter(function(e){return e[0]}).map(function(e){return e[1]}).map(this.conv.bind(this)).value();return 0===t.length?"\u65e0":t}},{key:"render",value:function(){return m.a.createElement(S.a,null,m.a.createElement(I.a,{span:6},"\u4efb\u52a1\uff1a"),m.a.createElement(I.a,{span:18},this.taskList()))}}]),t}(m.a.Component),ke=Object(v.b)(function(e,t){return{player:e.player,money:e.player.money,exping:e.player.exping,winN:e.player.winN,role:e.player.role,roles:e.player.roles,roleData:e.player.roleData,roleList:e.settings.role,people:e.settings.people,animal:e.settings.animal}})(Ee),Oe=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return m.a.createElement(I.a,{span:8},m.a.createElement(Z.a,{title:"\u4eba\u7269\u4fe1\u606f -- <".concat(this.props.userName,">"),style:{height:"300px"}},m.a.createElement(ce,null),m.a.createElement(ie,null),m.a.createElement(le,null),m.a.createElement(ge,null),m.a.createElement(ke,null)))}}]),t}(m.a.Component),je=Object(v.b)(function(e,t){return{userName:e.player.name}})(Oe),De=(a(71),a(34)),we=De.a.Button,Te=De.a.Group,xe=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"onChange",value:function(e){K({maping:e.target.value})}},{key:"render",value:function(){var e=this.props,t=e.maping,a=e.map,n=pe()(a[t][2]).map(function(e){return m.a.createElement(we,{key:"map_".concat(e),value:e},a[e][1])}).value();return m.a.createElement("div",null,m.a.createElement(S.a,null,m.a.createElement(I.a,{span:4},"\u901a\u5f80\uff1a"),m.a.createElement(I.a,null,m.a.createElement(Te,{onChange:this.onChange.bind(this)},n))))}}]),t}(m.a.Component),Ce=Object(v.b)(function(e,t){return{maping:e.player.maping,map:e.settings.map}})(xe),Se=De.a.Button,Ie=De.a.Group,Ae=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"onChange",value:function(e){K({fightN:!0,fightA:e.target.value})}},{key:"info",value:function(e){var t=this.props.animal[e];return m.a.createElement("div",null,m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u5c5e\u6027\uff1a"),m.a.createElement(I.a,{span:16},t[1],"\u7ea7-",t[9],"\u7cfb")),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u653b\u51fb\uff1a"),m.a.createElement(I.a,{span:16},t[3])),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u9632\u5fa1\uff1a"),m.a.createElement(I.a,{span:16},t[4])),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u751f\u547d\uff1a"),m.a.createElement(I.a,{span:16},t[2])),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u91d1\u94b1\uff1a"),m.a.createElement(I.a,{span:16},t[5])),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u7ecf\u9a8c\uff1a"),m.a.createElement(I.a,{span:16},t[6])),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u9b54\u6cd5\uff1a"),m.a.createElement(I.a,{span:16},t[7],"\u79d2",t[8],"\u4f24\u5bb3")))}},{key:"render",value:function(){var e=this,t=this.props,a=t.maping,n=t.map,i=t.animal;if(0===n[a][3].length)return null;var r=pe()(n[a][3]).map(function(t){var a=i[t];return m.a.createElement(ee.a,{key:"animal_".concat(t),content:e.info(t),title:"\u602a\u7269\u4fe1\u606f - <".concat(a[0],">")},m.a.createElement(Se,{value:t},a[0]))}).value();return m.a.createElement("div",null,m.a.createElement(S.a,null,m.a.createElement(I.a,{span:4},"\u602a\u7269\uff1a"),m.a.createElement(I.a,null,m.a.createElement(Ie,{onChange:this.onChange.bind(this)},r))))}}]),t}(m.a.Component),Le=Object(v.b)(function(e,t){return{maping:e.player.maping,map:e.settings.map,animal:e.settings.animal}})(Ae),_e=De.a.Button,Ne=De.a.Group,Me=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={id:-1,hidden:!1,count:0,hiddenID:-1},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.state.hiddenID>=0&&clearTimeout(this.state.hiddenID)}},{key:"onChange",value:function(e){var t=e.target.value;if(this.props.player.role[t])return J.a.error("\u4f60\u5f53\u524d\u5df2\u6709\u4efb\u52a1\u5728\u8eab\uff01"),null;var a=this.props.role[t];if(this.props.player.roles[t]>=a.length)return J.a.warning("\u6ca1\u6709\u66f4\u591a\u4efb\u52a1\u4e86\uff01"),null;this.setState({id:t,visible:!0})}},{key:"reloading",value:function(){this.state.count<100?this.setState({count:this.state.count+10,hidden:!0,hiddenID:setTimeout(this.reloading.bind(this),100)}):this.setState({hidden:!1,count:0,hiddenID:-1})}},{key:"reload",value:function(){this.setState({hidden:!0,hiddenID:setTimeout(this.reloading.bind(this),100)})}},{key:"initTask0",value:function(e){return{type:0,id:e[5][0],all:e[5][1],count:0}}},{key:"initTask",value:function(e,t){switch(t[0]){case 0:return this.initTask0(t)}return null}},{key:"initTaskData",value:function(e,t){var a=this.props.roleData;return a[e]=this.initTask(e,t),a}},{key:"handleTask",value:function(){var e=this.state.id,t=this.props.role[e][this.props.player.roles[e]],a=this.props.player.role;a[e]=!0,K({role:a,roleData:this.initTaskData(e,t)})}},{key:"handleOk",value:function(){this.handleTask(),this.setState({visible:!1}),this.reload()}},{key:"handleCancel",value:function(){this.setState({id:-1,visible:!1}),this.reload()}},{key:"taskInfo0",value:function(e){var t=Object(ye.a)(e[5],2),a=t[0],n=t[1],i=this.props.animal[a];return"\u6253\u8d25<".concat(n,">\u53ea<").concat(i[0],">")}},{key:"taskInfo",value:function(e){switch(e[0]){case 0:return this.taskInfo0(e)}return"task: unknown info"}},{key:"talk",value:function(){if(this.state.id>=0){var e=this.props,t=e.role,a=e.people,n=e.player,i=t[this.state.id],r=a[this.state.id],o=n.roles[this.state.id];if(o>=i.length)return J.a.warning("\u6ca1\u6709\u66f4\u591a\u4efb\u52a1\u4e86\uff01"),null;var l=i[o];return m.a.createElement(z.a,{title:"\u4e0e<".concat(r[1]," - ").concat(r[2],">\u5bf9\u8bdd\u4e2d \u2014\u2014 **").concat(l[1],"**"),visible:this.state.visible,onOk:this.handleOk.bind(this),onCancel:this.handleCancel.bind(this),okText:l[3],cancelText:l[4]},m.a.createElement("p",null,l[2]),m.a.createElement("br",null),m.a.createElement("br",null),m.a.createElement("br",null),m.a.createElement("hr",null),m.a.createElement("p",null,"\u4efb\u52a1\u7c7b\u578b\uff1a",m.a.createElement("b",null,fe(l[0]))),m.a.createElement("p",null,"\u4efb\u52a1\u76ee\u6807\uff1a",m.a.createElement("b",null,this.taskInfo(l))),m.a.createElement("p",null,"\u4efb\u52a1\u5956\u52b1\uff1a",m.a.createElement("b",null,"<$",l[8],">\u91d1\u94b1"),"\u548c",m.a.createElement("b",null,"<",l[9],">\u7ecf\u9a8c")))}return null}},{key:"conv",value:function(e,t){return pe()(t.split(/\n/)).map(function(t,a){return m.a.createElement("p",{key:"people_".concat(e,"_").concat(a)},t)}).value()}},{key:"render",value:function(){var e=this,t=this.props,a=t.maping,n=t.map,i=t.people;if(0===n[a][4].length)return null;var r=pe()(n[a][4]).map(function(t){var a=i[t];return m.a.createElement(ee.a,{key:"people_".concat(t),content:e.conv(t,a[4]),title:"<".concat(a[1],"> - <").concat(a[2],">")},m.a.createElement(_e,{value:t},a[2]))}).value();return m.a.createElement("div",null,m.a.createElement(S.a,null,m.a.createElement(I.a,{span:4},"NPC\uff1a"),m.a.createElement(I.a,null,this.state.hidden?m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u51c6\u5907\u4e2d..."),m.a.createElement(I.a,{span:8},m.a.createElement(te.a,{percent:this.state.count,status:"active",showInfo:!1}))):m.a.createElement(Ne,{onChange:this.onChange.bind(this)},r))),this.talk())}}]),t}(m.a.Component),We=Object(v.b)(function(e,t){return{maping:e.player.maping,player:e.player,roleData:e.player.roleData,map:e.settings.map,role:e.settings.role,animal:e.settings.animal,people:e.settings.people}})(Me),Fe=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getMapName",value:function(){var e=this.props,t=e.maping;return e.map[t][1]}},{key:"render",value:function(){return m.a.createElement(I.a,{span:8},m.a.createElement(Z.a,{title:"\u5f53\u524d\u5730\u56fe -- <".concat(this.getMapName(),">"),style:{height:"300px"}},m.a.createElement(Ce,null),m.a.createElement("br",null),m.a.createElement(We,null),m.a.createElement("br",null),m.a.createElement(Le,null)))}}]),t}(m.a.Component),Ue=Object(v.b)(function(e,t){return{maping:e.player.maping,map:e.settings.map}})(Fe),He=(a(246),a(128)),Be=De.a.Button,Re=De.a.Group,Ge=function(e){function t(e){var a;Object(o.a)(this,t);var n=(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).props.player.states.good;if(null!=n){if(null==n.obj)return Object(s.a)(a);var i=n.obj,r=n.count,l=n.all;a.state={obj:i,count:r,all:l,goodID:setTimeout(a.rec2.bind(Object(ae.a)(Object(ae.a)(a))),1e3)}}else a.state={hidden:!1,obj:null,count:0,all:100,goodID:-1};return a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.state.goodID>=0&&clearTimeout(this.state.goodID)}},{key:"rec1",value:function(){var e=this.state,t=e.count,a=e.all;this.setState({count:t+10}),t<=a?this.setState({goodID:setTimeout(this.rec1.bind(this),100)}):this.setState({hidden:!1,count:0,all:100})}},{key:"rec2",value:function(){var e=this.state,t=e.count,a=e.all;this.setState({count:t+10}),t+10<=a&&this.props.player.useblood>0?this.setState({goodID:setTimeout(this.rec2.bind(this),100)}):this.setState({hidden:!1,count:0,all:100})}},{key:"onChange",value:function(e){var t=this.props,a=t.money,n=t.goods[e.target.value];this.setState({hidden:!0}),a<n[3]||(K({money:a-n[3]}),J.a.success("\u8d2d\u4e70<".concat(n[2],">\u6210\u529f\uff01")),0===n[5]?(this.setState({goodID:setTimeout(this.rec1.bind(this),100)}),de(this.props.player,n),J.a.success("".concat(he(n[1]),"\u589e\u52a0").concat(n[4],"\uff01"))):(this.setState({count:0,all:100*n[5]}),K({states:{good:{obj:n,count:0,all:100*n[5]}}}),this.setState({goodID:setTimeout(this.rec2.bind(this),100)})))}},{key:"conv",value:function(e){var t=he(e[1]);return m.a.createElement("div",null,m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u7c7b\u578b\uff1a"),m.a.createElement(I.a,{span:16},t,"\u836f\u6c34")),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u91d1\u94b1\uff1a"),m.a.createElement(I.a,{span:16},e[3])),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:8},"\u6548\u679c\uff1a"),m.a.createElement(I.a,{span:16},me(e[5]),"\u589e\u52a0",e[4],t)))}},{key:"render",value:function(){var e=this,t=this.props,a=t.money,n=t.goods;if(0===n.length)return null;var i=pe()(n).map(function(t){var n=t[0];return a<t[3]?m.a.createElement(Be,{key:"good_".concat(n),disabled:!0,value:n},t[2]):m.a.createElement(ee.a,{key:"good_".concat(n),content:e.conv(t),title:"\u7269\u54c1\u4fe1\u606f -- <".concat(t[2],">")},m.a.createElement(Be,{value:n},t[2]))}).value();return this.state.hidden?m.a.createElement(S.a,null,m.a.createElement(I.a,null,m.a.createElement(te.a,{percent:100*this.state.count/this.state.all,status:"active",showInfo:!1})),m.a.createElement("br",null),m.a.createElement(I.a,null,m.a.createElement(He.a,null),"\u2003\u51c6\u5907\u4e2d...")):m.a.createElement(S.a,null,m.a.createElement(I.a,null,m.a.createElement(Re,{onChange:this.onChange.bind(this)},i)))}}]),t}(m.a.Component),ze=Object(v.b)(function(e,t){return{player:e.player,money:e.player.money,goods:e.settings.goods}})(Ge),Ve=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return m.a.createElement(I.a,{span:8},m.a.createElement(Z.a,{title:"\u5546\u5e97",style:{height:"300px"}},m.a.createElement(ze,null)))}}]),t}(m.a.Component),qe=Object(v.b)(function(e,t){return{}})(Ve),Pe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={enable:!0,showID:-1},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.state.showID&&clearTimeout(this.state.showID)}},{key:"reload",value:function(){this.setState({enable:!0,showID:-1})}},{key:"onClick",value:function(){var e;this.state.enable&&(e=4+ve(),0===Math.floor(Math.random()*e)?(J.a.success("\u9003\u8dd1\u6210\u529f\uff01"),K({fightN:!1,fightA:0,fightL:[],winN:[]})):(J.a.error("\u9003\u8dd1\u5931\u8d25\uff01"),this.setState({enable:!1,showID:setTimeout(this.reload.bind(this),5e3)})))}},{key:"render",value:function(){return m.a.createElement(P.a,{type:"primary",loading:!this.state.enable,onClick:this.onClick.bind(this)},"\u9003\u8dd1")}}]),t}(m.a.Component),$e=Object(v.b)(function(e,t){return{}})(Pe),Je=function(e){function t(e){var a;Object(o.a)(this,t);var n=(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).props,i=n.player,r=n.animal[i.fightA];return a.state={ani:r,blood:r[2],magic:r[7],magicID:-1,playerID:-1,animalID:-1,overID:-1},a.addFightLog(1,"<".concat(i.name,">\u4e0e<").concat(r[0],">\u5f00\u59cb\u4ea4\u6218\uff01")),setTimeout(a.combat.bind(Object(ae.a)(Object(ae.a)(a))),100),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){var e=this.state,t=e.magicID,a=e.playerID,n=e.animalID,i=e.overID;t>=0&&clearTimeout(t),a>=0&&clearTimeout(a),n>=0&&clearTimeout(n),i>=0&&clearTimeout(i)}},{key:"combat",value:function(){var e=this.props,t=e.player,a=e.animal[t.fightA];this.addFightLog(1,"<".concat(t.name,">\u5c06\u5728").concat(a[7],"\u79d2\u5185\u53d7\u5230<").concat(a[0],">").concat(a[7]*a[8],"\u70b9\u9b54\u6cd5\u4f24\u5bb3\uff01")),this.setState({magicID:setTimeout(this.magicCombat.bind(this),1e3)}),setTimeout(this.physicalCombat.bind(this),0)}},{key:"magicCombat",value:function(){var e=this.props,t=e.player,a=e.animal[t.fightA];if(this.state.magic>0){if(t.useblood<=a[8])return;K({useblood:t.useblood-a[8]}),this.addFightLog(2,"<".concat(t.name,">\u53d7\u5230<").concat(a[0],">").concat(a[8],"\u70b9\u9b54\u6cd5\u4f24\u5bb3\uff01")),this.setState({magic:this.state.magic-1,magicID:setTimeout(this.magicCombat.bind(this),1e3)})}}},{key:"physicalCombat",value:function(){this.setState({playerID:setTimeout(this.playerCombat.bind(this),100)})}},{key:"playerCombat",value:function(){var e=this.props,t=e.player,a=e.animal[t.fightA],n=pe.a.max([0,t.att+ve()-a[4]]);n>0?this.addFightLog(0,"<".concat(a[0],">\u53d7\u5230<").concat(t.name,">").concat(n,"\u70b9\u7269\u7406\u4f24\u5bb3\uff01")):this.addFightLog(1,"<".concat(a[0],">\u6210\u529f\u8eb2\u8fc7\u4e86<").concat(t.name,">\u7684\u653b\u51fb\uff01")),this.setState({blood:this.state.blood-n}),t.useblood>0&&!this.checkCombatFinish()&&this.setState({animalID:setTimeout(this.animalCombat.bind(this),1e3)})}},{key:"animalCombat",value:function(){var e=this.props,t=e.player,a=e.animal[t.fightA],n=pe.a.max([0,a[3]+ve()-t.def]);n>0?this.addFightLog(2,"<".concat(t.name,">\u53d7\u5230<").concat(a[0],">").concat(n,"\u70b9\u7269\u7406\u4f24\u5bb3\uff01")):this.addFightLog(1,"<".concat(t.name,">\u6210\u529f\u8eb2\u8fc7\u4e86<").concat(a[0],">\u7684\u653b\u51fb\uff01")),K({useblood:t.useblood-n}),t.useblood>n&&this.setState({playerID:setTimeout(this.playerCombat.bind(this),1e3)})}},{key:"checkCombatFinish",value:function(){return this.state.blood<0&&(setTimeout(this.combatOver.bind(this),100),!0)}},{key:"combatOver",value:function(){var e=this.props,t=e.player,a=e.animal,n=e.winN,i=a[t.fightA],r=i[5]+Math.floor(ve()/2),o=i[6]+Math.floor(ve()/2),l=["<".concat(t.name,">\u6253\u8d25\u4e86<").concat(i[0],">\uff01"),"<".concat(t.name,">\u83b7\u5f97\u4e86<$").concat(r,"\u91d1\u94b1>\u548c<").concat(o,"\u7ecf\u9a8c>\uff01")];this.addFightLog(0,l[0]),J.a.success(l[0]),this.addFightLog(0,l[1]),J.a.success(l[1]),n.push({id:t.fightA,count:1}),K({winN:n,money:t.money+r,exping:t.exping+o}),this.setState({overID:setTimeout(function(){K({fightN:!1,fightA:0,fightL:[]})},2e3)})}},{key:"addFightLog",value:function(e,t){var a=this.props.player.fightL||[];a.length>4&&a.pop(),K({fightL:[[e,t]].concat(Object(A.a)(a))})}},{key:"render",value:function(){var e=this.state,t=e.ani,a=100*e.blood/t[2];return m.a.createElement("div",null,m.a.createElement(S.a,null,m.a.createElement(I.a,{span:6},"\u5c5e\u6027\uff1a"),m.a.createElement(I.a,{span:18},t[1],"\u7ea7-",t[9],"\u7cfb")),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:6},"\u91d1\u94b1\uff1a"),m.a.createElement(I.a,{span:18},"$",t[5])),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:6},"\u653b\u51fb\uff1a"),m.a.createElement(I.a,{span:18},t[3])),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:6},"\u9632\u5fa1\uff1a"),m.a.createElement(I.a,{span:18},t[4])),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:6},"\u751f\u547d\uff1a"),m.a.createElement(I.a,{span:18},m.a.createElement(te.a,{percent:a,showInfo:!1}))),m.a.createElement(S.a,null,m.a.createElement(I.a,{span:6},"\u7ecf\u9a8c\uff1a"),m.a.createElement(I.a,{span:18},t[6])),m.a.createElement("br",null),m.a.createElement($e,null))}}]),t}(m.a.Component),Ye=Object(v.b)(function(e,t){return{player:e.player,animal:e.settings.animal,winN:e.player.winN}})(Je),Ke=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.fightA,a=e.animal[t];return m.a.createElement(I.a,{span:8},m.a.createElement(Z.a,{title:"\u602a\u7269\u4fe1\u606f -- <".concat(a[0],">"),style:{height:"300px"}},m.a.createElement(Ye,null)))}}]),t}(m.a.Component),Qe=Object(v.b)(function(e,t){return{fightA:e.player.fightA,animal:e.settings.animal}})(Ke),Xe=(a(249),a(97)),Ze=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"fightColor",value:function(e){switch(e){case 0:return"green";case 1:return"blue";case 2:return"red"}return"blue"}},{key:"fightList",value:function(){var e=this,t=this.props.fightL;return pe.a.chain(t).map(function(t,a){return m.a.createElement(Xe.a.Item,{key:"fight_".concat(a),color:e.fightColor(t[0])},t[1])}).value()}},{key:"render",value:function(){return m.a.createElement(I.a,{span:8},m.a.createElement(Z.a,{title:"\u6218\u6597\u60c5\u51b5",style:{height:"300px"}},m.a.createElement(Xe.a,null,this.fightList())))}}]),t}(m.a.Component),et=Object(v.b)(function(e,t){return{fightL:e.player.fightL}})(Ze),tt=p.a.Content,at=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return m.a.createElement("div",null,m.a.createElement(p.a,null,m.a.createElement(tt,{style:{padding:"10px"}},m.a.createElement(S.a,null,m.a.createElement(je,null),this.props.fightN?m.a.createElement(et,null):m.a.createElement(Ue,null),this.props.fightN?m.a.createElement(Qe,null):m.a.createElement(qe,null)))))}}]),t}(m.a.Component),nt=Object(v.b)(function(e,t){return{fightN:e.player.fightN}})(at),it=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={isOverlayOpaque:!0,isLaptopLowered:!1,step:"fade-in"},T({scene:"default"}),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.setState({isOverlayOpaque:!1})},200)}},{key:"handleOverlayDone",value:function(){var e=this;setTimeout(function(){e.setState({step:"intro"})},200)}},{key:"over",value:function(){var e=this.props.settings,t={name:"\u533f\u540d\u73a9\u5bb6",level:1,exping:0,exped:0,money:0,blood:100,useblood:100,att:6,def:6,fightN:!1,fightA:0,fightL:[],maping:0,winN:[],states:{},role:[],roles:[],roleData:[]};t.useblood=t.blood,t.exped=e.exped[t.level],t.role=e.role.map(function(){return!1}),t.roles=e.role.map(function(){return 0}),t.roleData=e.role.map(function(){return{type:-1}}),K(t),re({ADD_blood:1}),T({scene:"normal"})}},{key:"renderContent",value:function(){if("intro"===this.state.step){var e=L(["[CRAWL]\u6e38\u620f\u7ed3\u675f\uff01","[CRAWL]Game over.","[CRAWL]......"],{defaultTextColor:"#fff"});return m.a.createElement(H,{key:"4",text:e,onTextComplete:this.over.bind(this)})}return null}},{key:"getDesktopWrap",value:function(){return"portrait"===this.props.viewportMode?{}:{width:"100%",margin:"0 auto"}}},{key:"render",value:function(){var e={fontSize:"portrait"===this.props.viewportMode?"0.8em":"0.5em"},t=Object(b.a)({},this.getDesktopWrap());return m.a.createElement("div",null,m.a.createElement(B,{isOpaque:this.state.isOverlayOpaque,onTransitionComplete:this.handleOverlayDone.bind(this)}),m.a.createElement(S.a,{type:"flex",justify:"space-around",align:"middle"},m.a.createElement(I.a,{style:e},m.a.createElement("div",{style:t},this.state.isLaptopLowered?null:m.a.createElement(G,null,this.renderContent())))))}}]),t}(m.a.Component),rt=Object(v.b)(function(e,t){return{player:e.player,settings:e.settings,viewportMode:e.global.viewportMode}})(it),ot=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return"intro"===this.props.scene?m.a.createElement(C,null,m.a.createElement(X,null)):"normal"===this.props.scene&&this.props.useblood>0?m.a.createElement(C,null,m.a.createElement(nt,null)):m.a.createElement(C,null,m.a.createElement(rt,null))}}]),t}(h.Component),lt=Object(v.b)(function(e,t){return{useblood:e.player.useblood,scene:e.global.scene}})(ot);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var st=p.a.Content,ct=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return m.a.createElement(v.a,{store:this.props.store},m.a.createElement(p.a,null,m.a.createElement(st,null,m.a.createElement(lt,null))))}}]),t}(m.a.Component);f.a.render(m.a.createElement(ct,{store:w}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[133,2,1]]]);
//# sourceMappingURL=main.f2037282.chunk.js.map